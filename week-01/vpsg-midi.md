# VPSG-MIDI

## Synopsis
The proposed system is a USB-MIDI controller that allows a player to experiment with using the playing style and expressive potential of a pedal steel guitar to control software instruments. 

The [first two paragraphs of this article](https://www.npr.org/2020/01/07/793989801/the-endless-potential-of-the-pedal-steel-guitar-an-odd-duck-by-any-measure) provide some context as to why one would wish to do such a thing. 

I will need a prototyping board with some Flash, a decent ADC, two Bela Trill multitouch sensors, an I2C controller for dealing with those, at least one decent channel of an ADC for reading the expression pedal, a fairly significant amount of GPIO, and much more time to spend on calibration and modelling logic than I've bargained for. 

* [Hardware units](./VPSG-00-Hardware%20units.drawio.pdf)
* [Hardware block diagram](./VPSG-01-Hardware%20block%20diagram.drawio.pdf)
* [Software block diagram](./VPSG-02-Software%20block%20diagram.drawio.pdf)
* [Hierarchy control diagram](./VPSG-03-Hierarchy%20control%20diagram.drawio.pdf)
* [Layered diagram](./VPSG-04-Layered%20diagram.drawio.pdf)


## Breakdown
The hardware modules of this system are: 

1. A pluck controller, based on a one-dimensional multitouch strip. This is binned into eight areas. Touch events in one of these areas will trigger a MIDI note-on event: the pitch of this note-on event is a function of (a) the current reading from the pitch controller, and (b) the pitch offset ('tuning') assigned to this area in the system instrument model. 

2. A pitch controller, based on a one-dimensional multitouch strip, octave select +/- buttons, and octave-select indicator LEDs. A single touch event on the multitouch strip controls the absolute pitch of touch events triggered from the pluck controller. The size of the touch event may be used to control MIDI note-off events (e.g., ending the touch event will mute all currently-sounding notes)

3. A foot pedal, which provides three momentary footswitches. Each of these footswitches actuates a ramped change in the instrument model's tuning: this emulates the behaviour of a real pedal steel guitar, where each pedal actuates a mechanical linkage that raises the tension of certain strings within the guitar tuning. 

3. An input for a standard 0-5VDC swell/expression pedal, which controls overall volume. 

A software 'instrument model' computes the current pitch and amplitude of all virtual strings based on: 

* touch events from the pitch controller, 
* GPIO events from the footpedal,
* touch events from the pluck controller

A multichannel MIDI processor generates MIDI note/continuous control messages based on the current state of the instrument model, merges these with MIDI Volume continuous control messages generated by the driver for the swell/expression pedal, and streams them over USB-MIDI to a host computer.

Notes: 

1. I've never designed a full system from scratch before!
2. The multitouch sensors are available today (the Bela Trill: https://eu.shop.bela.io/collections/trill). They speak I2C. I want each of the modules to be separate for ergonomic reasons. I don't know if I'll get away with separating the modules by a couple feet or not. One way to find out! 
3. A USB-MIDI implementation is required. I haven't done any research into this yet!

